{% extends "base.html" %}
{% load static %}

{% block tab_title %}| My Profile{% endblock %}

{% block payment %}
    <section class="footer-pusher">
        <h1 class="text-capitalize mt-3">my profile</h1> 

        {% if messages %} 
            {% for message in messages %}
                <div class="font-weight-bolder text-danger text-left col-12 mb-4 text-center">
                    <p>{{ message }}</p>                           
                </div>
            {% endfor %}
        {% endif %}

        <div class="container mt-3">
            <div class="row">

                <div class="col-12 col-md-6">
                    <h2 class="text-capitalize">personal details</h2>
                    <form id="updateProfileForm" class="update-form-border mb-5" method="POST" action="{% url 'user_profiles' %}">
                        {% csrf_token %}
                        {{ form|crispy }}                    
                        <button class="form-submit-btn text-uppercase bg-secondary mt-4 font-weight-bolder" type="submit">update information</button>
                    </form>
                </div>
                                                  
                <div class="text-center">
                    <h2 class="text-center text-capitalize">order history</h2>   
                    <div class="table-responsive">
                        <table class="table table-sm table-borderless">
                            <thead>
                                <tr class=" text-capitalize">
                                    <th><strong>date</strong></th>
                                    <th><strong>grand total</strong></th>
                                    <th><strong>drink order number</strong></th>
                                    <th><strong>drink name</strong></th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for drink_order in drink_orders %}
                                    <tr>
                                        <td>
                                            <a href="{% url 'drink_order_history' drink_order.drink_order_number %}" title="{{ drink_order.drink_order_number }}">
                                                {{ drink_order.drink_order_number|truncatechars:6 }}
                                            </a>
                                        </td>
                                        <td>{{ drink_order.date }}</td>
                                        <td>
                                            <ul class="list-unstyled">
                                                {% for drink_item in drink_order.lineitems.all %}
                                                    <li class="small text-capitalize">
                                                        {{ drink_item.drink }} x{{ drink_item.drink_quantity }}
                                                    </li>
                                                {% endfor %}
                                            </ul>
                                        </td>
                                        <td>Â£{{ drink_order.grand_total }}</td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>                                          
                </div>   

            </div>
        </div>
        
    </section>
{% endblock %}


{% block postloadjs %}
    {{ block.super }}
    <script type="text/javascript">
        //  controls chaning text color of country field
        let selectedCountry = $("#id_default_country").val();
        if (!selectedCountry){
            $("#id_default_country").css("color", "#6c757d");
        };
        $("#id_default_country").change(function() {
            selectedCountry = $(this).val()
            if(!selectedCountry){
                $(this).css("color", "#6c757d");
            }else{
                $(this).css("color", "#212529");
            }
        }); 
    </script>
{% endblock %}

