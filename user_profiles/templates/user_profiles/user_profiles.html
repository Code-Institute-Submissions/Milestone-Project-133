{% extends "base.html" %}
{% load static %}

{% block tab_title %}| My Profile{% endblock %}

{% block payment %}
    <section class="footer-pusher">
        <h1 class="text-capitalize mt-3">my profile</h1> 

        {% if messages %} 
            {% for message in messages %}
                <div class="font-weight-bolder text-danger text-left col-12 mb-4 text-center">
                    <p>{{ message }}</p>                           
                </div>
            {% endfor %}
        {% endif %}

        <div class="container mt-3">
            <div class="row">

                <div class="col-12 col-md-6">
                    <h2 class="text-capitalize">personal details</h2>
                    <form id="updateProfileForm" class="update-form-border mb-5" method="POST" action="{% url 'user_profiles' %}">
                        {% csrf_token %}
                        {{ form|crispy }}                    
                        <button class="form-submit-btn text-uppercase bg-secondary mt-4 font-weight-bolder" type="submit">update information</button>
                    </form>
                </div>

                <div class="col-12 col-md-6">
                    <h2 class="text-capitalize">order history</h2> 
                    {% for drink_order in drink_orders %}  
                        <ul class="text-capitalize text-left order-history-border">
                            <li>
                                <strong>date: </strong>
                                {{ drink_order.date }}
                            </li>
                            <li>
                                <strong>grand total: </strong>
                                Â£{{ drink_order.grand_total }}
                            </li>
                            <li>
                                <strong>drink order number: </strong>
                                <a href="{% url 'drink_order_history' drink_order.drink_order_number %}" title="{{ drink_order.drink_order_number }}">{{ drink_order.drink_order_number|truncatechars:9 }}</a>
                            </li>
                            {% for drink_item in drink_order.lineitems.all %}
                                <li>
                                    <strong>drink name: </strong>
                                    {{ drink_item.drink }}
                                </li>
                                <li>
                                    <strong>drink quantity: </strong>
                                    {{ drink_item.drink_quantity }}
                                </li>
                            {% endfor %} 
                        </ul>
                    {% endfor %}                
                </div>
            </div>
        </div>

        {{ user_profiles }}
    </section>
{% endblock %}


{% block postloadjs %}
    {{ block.super }}
    <script type="text/javascript">
        //  controls chaning text color of country field
        let selectedCountry = $("#id_default_country").val();
        if (!selectedCountry){
            $("#id_default_country").css("color", "#6c757d");
        };
        $("#id_default_country").change(function() {
            selectedCountry = $(this).val()
            if(!selectedCountry){
                $(this).css("color", "#6c757d");
            }else{
                $(this).css("color", "#212529");
            }
        }); 
    </script>
{% endblock %}

